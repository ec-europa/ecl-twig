{% spaceless %}

{% set _menu_item_class = 'ecl-menu__link' %}
{% set _menu_item_attributes = 'data-ecl-menu-link' %}
{% set _menu_list_item_attributes = 'data-ecl-menu-item' %}
{% set _menu_list_item_class = 'ecl-menu__item' %}

{% if item.is_current is defined %}
  {% set _menu_item_class = _menu_item_class ~ ' ecl-menu__link--current' %}
  {% set _menu_list_item_class = _menu_list_item_class ~ ' ecl-menu__item--current' %}
{% endif %}

{% if item.children is defined and item.children is not empty %}
  {% set _menu_list_item_attributes = _menu_list_item_attributes ~ ' data-ecl-has-children=true' %}
{% else %}
  {% set _menu_list_item_attributes = _menu_list_item_attributes ~ ' data-ecl-has-children=false' %}
{% endif %}

<li class="{{ _menu_list_item_class }}" {{ _menu_list_item_attributes }}>
  <a href="{{ item.path }}" class="{{ _menu_item_class }}" {{ _menu_item_attributes }}>
    {{- item.label -}}
    {%- if item.children is defined and item.children is not empty and item.children is iterable -%}
      {% include '@ecl-twig/ec-component-icon/ecl-icon.html.twig' with {
        icon: {
          path: icon_path,
          type: 'ui',
          name: 'corner-arrow',
          size: 'xs',
          transform: 'rotate-180'
        },
        extra_classes: 'ecl-menu__link-icon',
      } %}
    {% endif %}
  </a>
{% if item.children is defined and item.children is not empty and item.children is iterable %}
  <div
    class="ecl-menu__mega"
    data-ecl-menu-mega
  >
    <ul class="ecl-menu__sublist">
    {% for child in item.children %}
      {% set _subitem_class = 'ecl-menu__subitem' ~ (child.is_current is defined ? ' ecl-menu__subitem--current' : '') %}
      <li class="{{ _subitem_class }}">
        {% set _sublink_class = 'ecl-menu__sublink' ~ (child.is_current is defined ? ' ecl-menu__sublink--current' : '') %}
        <a href="{{ child.path }}" class="{{ _sublink_class }}">
          {{- child.label -}}
        </a>
      </li>
    {% endfor %}
    </ul>
  </div>
{% endif %}
</li>

{% endspaceless %}
